# Porovnanie 3+ vzoriek, VV2020

# nacitanie kniznic pre pracu s google sheets a friedmanovym testom
library(gsheet)
library(PMCMRplus)

# nacitanie dat
senzorika=gsheet2tbl("https://docs.google.com/spreadsheets/d/1p4BvPonFJkBRvwfKxb4mWS37PTASk5sCx7eVhHrKtYw/edit?usp=sharing")


#Friedmanov test 
Friedman_kola=friedman.test(ck ~ produkt | hodnotitel,data = senzorika)
Friedman_kola$p.value
#porovnanie jednotlivych dvojic ak vypocitane p<0.05 (treba vykonat viacnasobne porovnanie)
FriedmanPARY=frdAllPairsConoverTest(y = senzorika$ck,groups = senzorika$produkt,blocks = senzorika$hodnotitel,p.adjust.method="bonferroni")
FriedmanPARY

#Kruskal Wallisov test
Kruskal_kola=kruskal.test(produkt ~ ck, data=senzorika) 
Kruskal_kola$p.value
# ak vypocitane p<0.05 (treba vykonat viacnasobne porovnanie vzoriek pomocou Wilcoxonovho testu)
pairwise.wilcox.test(senzorika$ck,senzorika$produkt, p.adj="bonferroni", exact=F)

# ANOVA
ANOVA_kola = aov(chut ~ produkt, data = senzorika)
summary(ANOVA_kola)
# ak vypocitane p<0.05 (treba vykonat viacnasobne porovnanie vzoriek pomocou Tukeyovho HSD)
TukeyHSD(ANOVA_kola)